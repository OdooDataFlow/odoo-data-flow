<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Guide: Advanced Usage" href="04_advanced_usage.html" /><link rel="prev" title="Guide: Exporting Data from Odoo" href="02_exporting_data.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Guide: Data Transformations with Mappers - Odoo Data Flow documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Odoo Data Flow  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Odoo Data Flow  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation with uv</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_concepts.html">Core Concepts</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">How-To Guides</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of How-To Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_importing_data.html">Guide: A Deep Dive into Importing</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_exporting_data.html">Guide: Exporting Data from Odoo</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Guide: Data Transformations with Mappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="04_advanced_usage.html">Guide: Advanced Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_performance_tuning.html">Guide: Performance Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_post_import_workflows.html">Guide: Post-Import Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_server_to_server_migration.html">Guide: Server-to-Server Migration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ &amp; Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../codeofconduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/OdooDataFlow/odoo-data-flow/releases">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ROADMAP.html">Project Roadmap</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/guides/03_data_transformations.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="guide-data-transformations-with-mappers">
<h1>Guide: Data Transformations with Mappers<a class="headerlink" href="#guide-data-transformations-with-mappers" title="Link to this heading">¶</a></h1>
<p>Mappers are the core of the data transformation process. They are powerful, reusable functions that you use within your mapping dictionary to define how each column of your destination file should be generated.</p>
<p>This guide provides a comprehensive reference for all mappers available in the <code class="docutils literal notranslate"><span class="pre">odoo_data_flow.lib.mapper</span></code> module.</p>
<hr class="docutils" />
<section id="data-quality-validation-processor-check">
<h2>Data Quality Validation (<code class="docutils literal notranslate"><span class="pre">Processor.check</span></code>)<a class="headerlink" href="#data-quality-validation-processor-check" title="Link to this heading">¶</a></h2>
<p>Before you start the main transformation process, it’s often a good idea to validate the quality and structure of your source data. The library provides a <code class="docutils literal notranslate"><span class="pre">.check()</span></code> method on the <code class="docutils literal notranslate"><span class="pre">Processor</span></code> object for this purpose.</p>
<p>You can call <code class="docutils literal notranslate"><span class="pre">.check()</span></code> multiple times with different “checker” functions to validate your data against a set of rules. If a check fails, a warning will be logged to the console, and you can prevent the transformation from continuing.</p>
<section id="using-checkers">
<h3>Using Checkers<a class="headerlink" href="#using-checkers" title="Link to this heading">¶</a></h3>
<p>In your <code class="docutils literal notranslate"><span class="pre">transform.py</span></code> script, after initializing the <code class="docutils literal notranslate"><span class="pre">Processor</span></code> but before calling <code class="docutils literal notranslate"><span class="pre">.process()</span></code>, you can add your checks:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">odoo_data_flow.lib</span><span class="w"> </span><span class="kn">import</span> <span class="n">checker</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">odoo_data_flow.lib.transform</span><span class="w"> </span><span class="kn">import</span> <span class="n">Processor</span>

<span class="c1"># Initialize processor</span>
<span class="n">processor</span> <span class="o">=</span> <span class="n">Processor</span><span class="p">(</span><span class="s1">&#39;origin/my_data.csv&#39;</span><span class="p">)</span>

<span class="c1"># --- Add Data Quality Checks ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running data quality checks...&quot;</span><span class="p">)</span>
<span class="n">processor</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">checker</span><span class="o">.</span><span class="n">line_length_checker</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="n">processor</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">checker</span><span class="o">.</span><span class="n">cell_len_checker</span><span class="p">(</span><span class="mi">120</span><span class="p">))</span>
<span class="n">processor</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">checker</span><span class="o">.</span><span class="n">id_validity_checker</span><span class="p">(</span><span class="s1">&#39;SKU&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;^[A-Z]</span><span class="si">{2}</span><span class="s1">-\d</span><span class="si">{4}</span><span class="s1">$&#39;</span><span class="p">))</span>

<span class="c1"># Now, proceed with the mapping and processing</span>
<span class="c1"># processor.process(...)</span>
</pre></div>
</div>
</section>
<section id="available-checker-functions">
<h3>Available Checker Functions<a class="headerlink" href="#available-checker-functions" title="Link to this heading">¶</a></h3>
<p>The following checkers are available in the <code class="docutils literal notranslate"><span class="pre">odoo_data_flow.lib.checker</span></code> module.</p>
<section id="checker-line-length-checker-expected-length">
<h4><code class="docutils literal notranslate"><span class="pre">checker.line_length_checker(expected_length)</span></code><a class="headerlink" href="#checker-line-length-checker-expected-length" title="Link to this heading">¶</a></h4>
<p>Verifies that every row in your data file has exactly the <code class="docutils literal notranslate"><span class="pre">expected_length</span></code> number of columns. This is useful for catching malformed CSV rows.</p>
</section>
<section id="checker-cell-len-checker-max-cell-len">
<h4><code class="docutils literal notranslate"><span class="pre">checker.cell_len_checker(max_cell_len)</span></code><a class="headerlink" href="#checker-cell-len-checker-max-cell-len" title="Link to this heading">¶</a></h4>
<p>Verifies that no single cell (field) in your entire dataset exceeds the <code class="docutils literal notranslate"><span class="pre">max_cell_len</span></code> number of characters.</p>
</section>
<section id="checker-line-number-checker-expected-line-count">
<h4><code class="docutils literal notranslate"><span class="pre">checker.line_number_checker(expected_line_count)</span></code><a class="headerlink" href="#checker-line-number-checker-expected-line-count" title="Link to this heading">¶</a></h4>
<p>Verifies that the file contains exactly <code class="docutils literal notranslate"><span class="pre">expected_line_count</span></code> number of data rows (not including the header).</p>
</section>
<section id="checker-id-validity-checker-id-field-pattern">
<h4><code class="docutils literal notranslate"><span class="pre">checker.id_validity_checker(id_field,</span> <span class="pre">pattern)</span></code><a class="headerlink" href="#checker-id-validity-checker-id-field-pattern" title="Link to this heading">¶</a></h4>
<p>Verifies that the value in the specified <code class="docutils literal notranslate"><span class="pre">id_field</span></code> column for every row matches the given regex <code class="docutils literal notranslate"><span class="pre">pattern</span></code>. This is extremely useful for ensuring key fields like SKUs or external IDs follow a consistent format.</p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="basic-mappers">
<h2>Basic Mappers<a class="headerlink" href="#basic-mappers" title="Link to this heading">¶</a></h2>
<section id="mapper-val-field-postprocess">
<h3><code class="docutils literal notranslate"><span class="pre">mapper.val(field,</span> <span class="pre">[postprocess])</span></code><a class="headerlink" href="#mapper-val-field-postprocess" title="Link to this heading">¶</a></h3>
<p>Retrieves the value from a single source column, identified by <code class="docutils literal notranslate"><span class="pre">field</span></code>. This is the most fundamental mapper.</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">field</span></code> (str)</strong>: The name of the column in the source file.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">postprocess</span></code> (function, optional)</strong>: A function to modify the value after it has been read.</p></li>
</ul>
</section>
<section id="mapper-const-value">
<h3><code class="docutils literal notranslate"><span class="pre">mapper.const(value)</span></code><a class="headerlink" href="#mapper-const-value" title="Link to this heading">¶</a></h3>
<p>Fills a column with a fixed, constant <code class="docutils literal notranslate"><span class="pre">value</span></code> for every row.</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">value</span></code></strong>: The static value to use (e.g., string, bool, integer).</p></li>
</ul>
<section id="how-it-works">
<h4>How it works<a class="headerlink" href="#how-it-works" title="Link to this heading">¶</a></h4>
<p><strong>Input Data (<code class="docutils literal notranslate"><span class="pre">source.csv</span></code>)</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>AnyColumn</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>a</p></td>
</tr>
<tr class="row-odd"><td><p>b</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Transformation Code</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;sale_type&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">const</span><span class="p">(</span><span class="s1">&#39;service&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Output Data</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>sale_type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>service</p></td>
</tr>
<tr class="row-odd"><td><p>service</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="combining-and-formatting">
<h2>Combining and Formatting<a class="headerlink" href="#combining-and-formatting" title="Link to this heading">¶</a></h2>
<section id="mapper-concat-separator-fields">
<h3><code class="docutils literal notranslate"><span class="pre">mapper.concat(separator,</span> <span class="pre">*fields)</span></code><a class="headerlink" href="#mapper-concat-separator-fields" title="Link to this heading">¶</a></h3>
<p>Joins values from one or more source columns together, separated by a given <code class="docutils literal notranslate"><span class="pre">separator</span></code>.</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">separator</span></code> (str)</strong>: The string to place between each value.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">*fields</span></code> (str)</strong>: A variable number of source column names (<code class="docutils literal notranslate"><span class="pre">field</span></code>) or static strings to join.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="conditional-and-boolean-logic">
<h2>Conditional and Boolean Logic<a class="headerlink" href="#conditional-and-boolean-logic" title="Link to this heading">¶</a></h2>
<section id="mapper-cond-field-true-value-false-value">
<h3><code class="docutils literal notranslate"><span class="pre">mapper.cond(field,</span> <span class="pre">true_value,</span> <span class="pre">false_value)</span></code><a class="headerlink" href="#mapper-cond-field-true-value-false-value" title="Link to this heading">¶</a></h3>
<p>Checks the value of the source column <code class="docutils literal notranslate"><span class="pre">field</span></code>. If it’s considered “truthy” (not empty, not “False”, not 0), it returns <code class="docutils literal notranslate"><span class="pre">true_value</span></code>, otherwise it returns <code class="docutils literal notranslate"><span class="pre">false_value</span></code>.</p>
</section>
<section id="mapper-bool-val-field-true-values">
<h3><code class="docutils literal notranslate"><span class="pre">mapper.bool_val(field,</span> <span class="pre">true_values)</span></code><a class="headerlink" href="#mapper-bool-val-field-true-values" title="Link to this heading">¶</a></h3>
<p>Checks if the value in the source column <code class="docutils literal notranslate"><span class="pre">field</span></code> exists within the <code class="docutils literal notranslate"><span class="pre">true_values</span></code> list and returns a boolean.</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">field</span></code> (str)</strong>: The column to check.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">true_values</span></code> (list)</strong>: A list of strings that should be considered <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
<section id="id1">
<h4>How it works<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<p><strong>Input Data (<code class="docutils literal notranslate"><span class="pre">source.csv</span></code>)</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Status</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Active</p></td>
</tr>
<tr class="row-odd"><td><p>Done</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Transformation Code</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;is_active&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">bool_val</span><span class="p">(</span><span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Active&#39;</span><span class="p">,</span> <span class="s1">&#39;In Progress&#39;</span><span class="p">]),</span>
</pre></div>
</div>
<p><strong>Output Data</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>is_active</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>True</p></td>
</tr>
<tr class="row-odd"><td><p>False</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="numeric-mappers">
<h2>Numeric Mappers<a class="headerlink" href="#numeric-mappers" title="Link to this heading">¶</a></h2>
<section id="mapper-num-field-default-0-0">
<h3><code class="docutils literal notranslate"><span class="pre">mapper.num(field,</span> <span class="pre">default='0.0')</span></code><a class="headerlink" href="#mapper-num-field-default-0-0" title="Link to this heading">¶</a></h3>
<p>Takes the numeric value of the source column <code class="docutils literal notranslate"><span class="pre">field</span></code>. It automatically transforms a comma decimal separator (<code class="docutils literal notranslate"><span class="pre">,</span></code>) into a dot (<code class="docutils literal notranslate"><span class="pre">.</span></code>). Use it for <code class="docutils literal notranslate"><span class="pre">Integer</span></code> or <code class="docutils literal notranslate"><span class="pre">Float</span></code> fields in Odoo.</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">field</span></code> (str)</strong>: The column containing the numeric string.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">default</span></code> (str, optional)</strong>: A default value to use if the source value is empty. Defaults to <code class="docutils literal notranslate"><span class="pre">'0.0'</span></code>.</p></li>
</ul>
<section id="id2">
<h4>How it works<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<p><strong>Input Data (<code class="docutils literal notranslate"><span class="pre">source.csv</span></code>)</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>my_column</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>01</p></td>
</tr>
<tr class="row-odd"><td><p>2,3</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Transformation Code</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;my_field&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">num</span><span class="p">(</span><span class="s1">&#39;my_column&#39;</span><span class="p">),</span>
<span class="s1">&#39;my_field_with_default&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">num</span><span class="p">(</span><span class="s1">&#39;my_column&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;-1.0&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Output Data</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>my_field</p></th>
<th class="head"><p>my_field_with_default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>2.3</p></td>
<td><p>2.3</p></td>
</tr>
<tr class="row-even"><td><p>0.0</p></td>
<td><p>-1.0</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="relational-mappers">
<h2>Relational Mappers<a class="headerlink" href="#relational-mappers" title="Link to this heading">¶</a></h2>
<section id="mapper-m2o-map-prefix-fields">
<h3><code class="docutils literal notranslate"><span class="pre">mapper.m2o_map(prefix,</span> <span class="pre">*fields)</span></code><a class="headerlink" href="#mapper-m2o-map-prefix-fields" title="Link to this heading">¶</a></h3>
<p>A specialized <code class="docutils literal notranslate"><span class="pre">concat</span></code> for creating external IDs for <strong>Many2one</strong> relationship fields (e.g., <code class="docutils literal notranslate"><span class="pre">partner_id</span></code>).</p>
</section>
<section id="mapper-relation-model-search-field-value-raise-if-not-found-false-skip-false">
<h3><code class="docutils literal notranslate"><span class="pre">mapper.relation(model,</span> <span class="pre">search_field,</span> <span class="pre">value,</span> <span class="pre">raise_if_not_found=False,</span> <span class="pre">skip=False)</span></code><a class="headerlink" href="#mapper-relation-model-search-field-value-raise-if-not-found-false-skip-false" title="Link to this heading">¶</a></h3>
<p>Finds a single record in Odoo and returns its database ID. <strong>Note:</strong> This can be slow as it performs a search for each row.</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">model</span></code> (str)</strong>: The Odoo model to search in.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">search_field</span></code> (str)</strong>: The field to search on.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">value</span></code> (mapper)</strong>: A mapper that provides the value to search for.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">raise_if_not_found</span></code> (bool, optional)</strong>: If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the process will stop if no record is found. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">skip</span></code> (bool, optional)</strong>: If <code class="docutils literal notranslate"><span class="pre">True</span></code> and the record is not found, the entire source row will be skipped. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</section>
<section id="many-to-many-mappers">
<h3>Many-to-Many Mappers<a class="headerlink" href="#many-to-many-mappers" title="Link to this heading">¶</a></h3>
<p>These mappers create a comma-separated list of external IDs or database ID command tuples for <strong>Many2many</strong> fields.</p>
<section id="mapper-m2m-args-kwargs">
<h4><code class="docutils literal notranslate"><span class="pre">mapper.m2m(*args,</span> <span class="pre">**kwargs)</span></code><a class="headerlink" href="#mapper-m2m-args-kwargs" title="Link to this heading">¶</a></h4>
<p>Has two modes:</p>
<ol class="arabic simple">
<li><p><strong>Multiple Columns</strong>: Joins non-empty values from multiple source columns. <code class="docutils literal notranslate"><span class="pre">mapper.m2m('Tag1',</span> <span class="pre">'Tag2')</span></code></p></li>
<li><p><strong>Single Column with Separator</strong>: Splits a single column by a separator. <code class="docutils literal notranslate"><span class="pre">mapper.m2m('Tags',</span> <span class="pre">sep=';')</span></code></p></li>
</ol>
</section>
<section id="mapper-m2m-map-prefix-field-sep">
<h4><code class="docutils literal notranslate"><span class="pre">mapper.m2m_map(prefix,</span> <span class="pre">field,</span> <span class="pre">sep)</span></code><a class="headerlink" href="#mapper-m2m-map-prefix-field-sep" title="Link to this heading">¶</a></h4>
<p>Splits a single source column <code class="docutils literal notranslate"><span class="pre">field</span></code> by <code class="docutils literal notranslate"><span class="pre">sep</span></code> and prepends a <code class="docutils literal notranslate"><span class="pre">prefix</span></code> to each value.</p>
</section>
<section id="mapper-m2m-id-list-field-sep">
<h4><code class="docutils literal notranslate"><span class="pre">mapper.m2m_id_list(field,</span> <span class="pre">sep=',')</span></code><a class="headerlink" href="#mapper-m2m-id-list-field-sep" title="Link to this heading">¶</a></h4>
<p>Takes a source column <code class="docutils literal notranslate"><span class="pre">field</span></code> containing a list of database IDs and formats them for Odoo’s <code class="docutils literal notranslate"><span class="pre">(6,</span> <span class="pre">0,</span> <span class="pre">[IDs])</span></code> command, which replaces all existing relations with the new list.</p>
</section>
<section id="mapper-m2m-value-list-model-field-sep">
<h4><code class="docutils literal notranslate"><span class="pre">mapper.m2m_value_list(model,</span> <span class="pre">field,</span> <span class="pre">sep=',')</span></code><a class="headerlink" href="#mapper-m2m-value-list-model-field-sep" title="Link to this heading">¶</a></h4>
<p>Takes a source column <code class="docutils literal notranslate"><span class="pre">field</span></code> containing a list of values (e.g., names). For each value, it finds the corresponding record in the specified <code class="docutils literal notranslate"><span class="pre">model</span></code> (by searching on the <code class="docutils literal notranslate"><span class="pre">name</span></code> field) and returns a list of their database IDs, formatted as a command tuple.</p>
</section>
<section id="mapper-m2m-template-attribute-value-field-sep">
<h4><code class="docutils literal notranslate"><span class="pre">mapper.m2m_template_attribute_value(field,</span> <span class="pre">sep=',')</span></code><a class="headerlink" href="#mapper-m2m-template-attribute-value-field-sep" title="Link to this heading">¶</a></h4>
<p>A highly specialized mapper for product template attributes. It takes a list of attribute values from the source column <code class="docutils literal notranslate"><span class="pre">field</span></code>, finds or creates them (<code class="docutils literal notranslate"><span class="pre">product.attribute.value</span></code>), and returns them formatted for the <code class="docutils literal notranslate"><span class="pre">attribute_line_ids</span></code> field.</p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="advanced-mapping">
<h2>Advanced Mapping<a class="headerlink" href="#advanced-mapping" title="Link to this heading">¶</a></h2>
<section id="mapper-map-val-map-dict-key-default-none-m2m-false">
<h3><code class="docutils literal notranslate"><span class="pre">mapper.map_val(map_dict,</span> <span class="pre">key,</span> <span class="pre">default=None,</span> <span class="pre">m2m=False)</span></code><a class="headerlink" href="#mapper-map-val-map-dict-key-default-none-m2m-false" title="Link to this heading">¶</a></h3>
<p>Looks up a <code class="docutils literal notranslate"><span class="pre">key</span></code> in a <code class="docutils literal notranslate"><span class="pre">map_dict</span></code> and returns the corresponding value. This is extremely useful for translating values from a source system to Odoo values.</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">map_dict</span></code> (dict)</strong>: The Python dictionary to use as a translation table.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">key</span></code> (mapper)</strong>: A mapper that provides the key to look up in the dictionary (often <code class="docutils literal notranslate"><span class="pre">mapper.val</span></code>).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">default</span></code> (optional)</strong>: A default value to return if the key is not found.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">m2m</span></code> (bool, optional)</strong>: If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the <code class="docutils literal notranslate"><span class="pre">key</span></code> is expected to be a list of values. The mapper will look up each value in the list and return a comma-separated string of the results.</p></li>
</ul>
<section id="example-advanced-country-mapping">
<h4>Example: Advanced Country Mapping<a class="headerlink" href="#example-advanced-country-mapping" title="Link to this heading">¶</a></h4>
<p><strong>Transformation Code</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The mapping dictionary translates source codes to Odoo external IDs.</span>
<span class="n">country_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;BE&#39;</span><span class="p">:</span> <span class="s1">&#39;base.be&#39;</span><span class="p">,</span>
    <span class="s1">&#39;FR&#39;</span><span class="p">:</span> <span class="s1">&#39;base.fr&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NL&#39;</span><span class="p">:</span> <span class="s1">&#39;base.nl&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Use map_val to look up the code and return the external ID.</span>
<span class="s1">&#39;country_id/id&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">map_val</span><span class="p">(</span><span class="n">country_map</span><span class="p">,</span> <span class="n">mapper</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="s1">&#39;CountryCode&#39;</span><span class="p">))</span>
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="binary-mappers">
<h2>Binary Mappers<a class="headerlink" href="#binary-mappers" title="Link to this heading">¶</a></h2>
<section id="mapper-binary-field">
<h3><code class="docutils literal notranslate"><span class="pre">mapper.binary(field)</span></code><a class="headerlink" href="#mapper-binary-field" title="Link to this heading">¶</a></h3>
<p>Reads a local file path from the source column <code class="docutils literal notranslate"><span class="pre">field</span></code> and converts the file content into a base64-encoded string.</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">field</span></code> (str)</strong>: The name of the column that contains the relative path to the image file.</p></li>
</ul>
<section id="id3">
<h4>How it works<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h4>
<p><strong>Input Data (<code class="docutils literal notranslate"><span class="pre">images.csv</span></code>)</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ImagePath</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>images/product_a.png</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Transformation Code</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reads the file at the path and encodes it for Odoo</span>
<span class="s1">&#39;image_1920&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">binary</span><span class="p">(</span><span class="s1">&#39;ImagePath&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Output Data</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>image_1920</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>iVBORw0KGgoAAAANSUhEUg… (etc.)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="mapper-binary-url-map-field">
<h3><code class="docutils literal notranslate"><span class="pre">mapper.binary_url_map(field)</span></code><a class="headerlink" href="#mapper-binary-url-map-field" title="Link to this heading">¶</a></h3>
<p>Reads a URL from the source column <code class="docutils literal notranslate"><span class="pre">field</span></code>, downloads the content from that URL, and converts it into a base64-encoded string.</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">field</span></code> (str)</strong>: The name of the column that contains the full URL to the image or file.</p></li>
</ul>
<section id="id4">
<h4>How it works<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h4>
<p><strong>Input Data (<code class="docutils literal notranslate"><span class="pre">image_urls.csv</span></code>)</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ImageURL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>https://www.example.com/logo.png</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Transformation Code</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Downloads the image from the URL and encodes it</span>
<span class="s1">&#39;image_1920&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">binary_url_map</span><span class="p">(</span><span class="s1">&#39;ImageURL&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Output Data</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>image_1920</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>iVBORw0KGgoAAAANSUhEUg… (etc.)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="advanced-techniques">
<h2>Advanced Techniques<a class="headerlink" href="#advanced-techniques" title="Link to this heading">¶</a></h2>
<section id="pre-processing-data">
<h3>Pre-processing Data<a class="headerlink" href="#pre-processing-data" title="Link to this heading">¶</a></h3>
<p>For complex manipulations before the mapping starts, you can pass a <code class="docutils literal notranslate"><span class="pre">preprocessor</span></code> function to the <code class="docutils literal notranslate"><span class="pre">Processor</span></code>. This function receives the CSV header and data and must return them after modification.</p>
<section id="adding-columns">
<h4>Adding Columns<a class="headerlink" href="#adding-columns" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">myPreprocessor</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;NEW_COLUMN&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;NEW_VALUE&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">header</span><span class="p">,</span> <span class="n">data</span>
</pre></div>
</div>
</section>
<section id="removing-lines">
<h4>Removing Lines<a class="headerlink" href="#removing-lines" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">myPreprocessor</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">data_new</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="s1">&#39;Firstname&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;John&#39;</span><span class="p">:</span>
            <span class="n">data_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">header</span><span class="p">,</span> <span class="n">data_new</span>
</pre></div>
</div>
</section>
</section>
<section id="creating-custom-mappers">
<h3>Creating Custom Mappers<a class="headerlink" href="#creating-custom-mappers" title="Link to this heading">¶</a></h3>
<p>Any Python function can act as a custom mapper when used with <code class="docutils literal notranslate"><span class="pre">postprocess</span></code>. The function will receive the value from the source column as its first argument and the shared <code class="docutils literal notranslate"><span class="pre">state</span></code> dictionary as its second.</p>
</section>
<section id="updating-records-with-database-ids">
<h3>Updating Records With Database IDs<a class="headerlink" href="#updating-records-with-database-ids" title="Link to this heading">¶</a></h3>
<p>To update records using their database ID, map your source ID to the special <code class="docutils literal notranslate"><span class="pre">.id</span></code> field and provide an empty <code class="docutils literal notranslate"><span class="pre">id</span></code> field.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">const</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
    <span class="s1">&#39;.id&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="s1">&#39;id_column_from_source&#39;</span><span class="p">),</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="s1">&#39;name_from_source&#39;</span><span class="p">),</span>
    <span class="c1"># ... other fields to update</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="creating-related-records-mapper-record">
<h3>Creating Related Records (<code class="docutils literal notranslate"><span class="pre">mapper.record</span></code>)<a class="headerlink" href="#creating-related-records-mapper-record" title="Link to this heading">¶</a></h3>
<p>This special mapper takes a full mapping dictionary to create related records (e.g., sales order lines) during the transformation of a main record.</p>
<section id="example-importing-sales-orders-and-their-lines">
<h4>Example: Importing Sales Orders and their Lines<a class="headerlink" href="#example-importing-sales-orders-and-their-lines" title="Link to this heading">¶</a></h4>
<p><strong>Input Data (<code class="docutils literal notranslate"><span class="pre">orders.csv</span></code>)</strong></p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>OrderID</p></th>
<th class="head"><p>Warehouse</p></th>
<th class="head"><p>SKU</p></th>
<th class="head"><p>Qty</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SO001</p></td>
<td><p>MAIN</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p></p></td>
<td><p>PROD_A</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p></p></td>
<td><p>PROD_B</p></td>
<td><p>5</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Transformation Code</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">odoo_data_flow.lib</span><span class="w"> </span><span class="kn">import</span> <span class="n">mapper</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_order_id</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">val</span><span class="p">:</span>
        <span class="n">state</span><span class="p">[</span><span class="s1">&#39;current_order_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">val</span>
    <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span><span class="w"> </span><span class="nf">remember_value</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">postprocess</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">val</span><span class="p">:</span>
            <span class="n">state</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">val</span>
    <span class="k">return</span> <span class="n">postprocess</span>

<span class="n">order_line_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;order_id/id&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">state</span><span class="p">:</span> <span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;current_order_id&#39;</span><span class="p">),</span>
    <span class="s1">&#39;product_id/id&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">m2o_map</span><span class="p">(</span><span class="s1">&#39;prod_&#39;</span><span class="p">,</span> <span class="s1">&#39;SKU&#39;</span><span class="p">),</span>
    <span class="s1">&#39;product_uom_qty&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">num</span><span class="p">(</span><span class="s1">&#39;Qty&#39;</span><span class="p">),</span>
    <span class="s1">&#39;warehouse_id/id&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">state</span><span class="p">:</span> <span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;current_warehouse_id&#39;</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">sales_order_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># Using a postprocess on val() is a flexible way to filter</span>
    <span class="s1">&#39;_filter&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="s1">&#39;OrderID&#39;</span><span class="p">,</span> <span class="n">postprocess</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="ow">not</span> <span class="n">x</span><span class="p">),</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="s1">&#39;OrderID&#39;</span><span class="p">),</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">val</span><span class="p">(</span><span class="s1">&#39;OrderID&#39;</span><span class="p">,</span> <span class="n">postprocess</span><span class="o">=</span><span class="n">get_order_id</span><span class="p">),</span>
    <span class="s1">&#39;warehouse_id/id&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">m2o_map</span><span class="p">(</span><span class="s1">&#39;wh_&#39;</span><span class="p">,</span> <span class="s1">&#39;Warehouse&#39;</span><span class="p">,</span> <span class="n">postprocess</span><span class="o">=</span><span class="n">remember_value</span><span class="p">(</span><span class="s1">&#39;current_warehouse_id&#39;</span><span class="p">)),</span>
    <span class="s1">&#39;order_line&#39;</span><span class="p">:</span> <span class="n">mapper</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="s1">&#39;SKU&#39;</span><span class="p">,</span> <span class="n">mapper</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">order_line_mapping</span><span class="p">))</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="04_advanced_usage.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Guide: Advanced Usage</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="02_exporting_data.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Guide: Exporting Data from Odoo</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, bosd
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Guide: Data Transformations with Mappers</a><ul>
<li><a class="reference internal" href="#data-quality-validation-processor-check">Data Quality Validation (<code class="docutils literal notranslate"><span class="pre">Processor.check</span></code>)</a><ul>
<li><a class="reference internal" href="#using-checkers">Using Checkers</a></li>
<li><a class="reference internal" href="#available-checker-functions">Available Checker Functions</a><ul>
<li><a class="reference internal" href="#checker-line-length-checker-expected-length"><code class="docutils literal notranslate"><span class="pre">checker.line_length_checker(expected_length)</span></code></a></li>
<li><a class="reference internal" href="#checker-cell-len-checker-max-cell-len"><code class="docutils literal notranslate"><span class="pre">checker.cell_len_checker(max_cell_len)</span></code></a></li>
<li><a class="reference internal" href="#checker-line-number-checker-expected-line-count"><code class="docutils literal notranslate"><span class="pre">checker.line_number_checker(expected_line_count)</span></code></a></li>
<li><a class="reference internal" href="#checker-id-validity-checker-id-field-pattern"><code class="docutils literal notranslate"><span class="pre">checker.id_validity_checker(id_field,</span> <span class="pre">pattern)</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#basic-mappers">Basic Mappers</a><ul>
<li><a class="reference internal" href="#mapper-val-field-postprocess"><code class="docutils literal notranslate"><span class="pre">mapper.val(field,</span> <span class="pre">[postprocess])</span></code></a></li>
<li><a class="reference internal" href="#mapper-const-value"><code class="docutils literal notranslate"><span class="pre">mapper.const(value)</span></code></a><ul>
<li><a class="reference internal" href="#how-it-works">How it works</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#combining-and-formatting">Combining and Formatting</a><ul>
<li><a class="reference internal" href="#mapper-concat-separator-fields"><code class="docutils literal notranslate"><span class="pre">mapper.concat(separator,</span> <span class="pre">*fields)</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#conditional-and-boolean-logic">Conditional and Boolean Logic</a><ul>
<li><a class="reference internal" href="#mapper-cond-field-true-value-false-value"><code class="docutils literal notranslate"><span class="pre">mapper.cond(field,</span> <span class="pre">true_value,</span> <span class="pre">false_value)</span></code></a></li>
<li><a class="reference internal" href="#mapper-bool-val-field-true-values"><code class="docutils literal notranslate"><span class="pre">mapper.bool_val(field,</span> <span class="pre">true_values)</span></code></a><ul>
<li><a class="reference internal" href="#id1">How it works</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#numeric-mappers">Numeric Mappers</a><ul>
<li><a class="reference internal" href="#mapper-num-field-default-0-0"><code class="docutils literal notranslate"><span class="pre">mapper.num(field,</span> <span class="pre">default='0.0')</span></code></a><ul>
<li><a class="reference internal" href="#id2">How it works</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#relational-mappers">Relational Mappers</a><ul>
<li><a class="reference internal" href="#mapper-m2o-map-prefix-fields"><code class="docutils literal notranslate"><span class="pre">mapper.m2o_map(prefix,</span> <span class="pre">*fields)</span></code></a></li>
<li><a class="reference internal" href="#mapper-relation-model-search-field-value-raise-if-not-found-false-skip-false"><code class="docutils literal notranslate"><span class="pre">mapper.relation(model,</span> <span class="pre">search_field,</span> <span class="pre">value,</span> <span class="pre">raise_if_not_found=False,</span> <span class="pre">skip=False)</span></code></a></li>
<li><a class="reference internal" href="#many-to-many-mappers">Many-to-Many Mappers</a><ul>
<li><a class="reference internal" href="#mapper-m2m-args-kwargs"><code class="docutils literal notranslate"><span class="pre">mapper.m2m(*args,</span> <span class="pre">**kwargs)</span></code></a></li>
<li><a class="reference internal" href="#mapper-m2m-map-prefix-field-sep"><code class="docutils literal notranslate"><span class="pre">mapper.m2m_map(prefix,</span> <span class="pre">field,</span> <span class="pre">sep)</span></code></a></li>
<li><a class="reference internal" href="#mapper-m2m-id-list-field-sep"><code class="docutils literal notranslate"><span class="pre">mapper.m2m_id_list(field,</span> <span class="pre">sep=',')</span></code></a></li>
<li><a class="reference internal" href="#mapper-m2m-value-list-model-field-sep"><code class="docutils literal notranslate"><span class="pre">mapper.m2m_value_list(model,</span> <span class="pre">field,</span> <span class="pre">sep=',')</span></code></a></li>
<li><a class="reference internal" href="#mapper-m2m-template-attribute-value-field-sep"><code class="docutils literal notranslate"><span class="pre">mapper.m2m_template_attribute_value(field,</span> <span class="pre">sep=',')</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-mapping">Advanced Mapping</a><ul>
<li><a class="reference internal" href="#mapper-map-val-map-dict-key-default-none-m2m-false"><code class="docutils literal notranslate"><span class="pre">mapper.map_val(map_dict,</span> <span class="pre">key,</span> <span class="pre">default=None,</span> <span class="pre">m2m=False)</span></code></a><ul>
<li><a class="reference internal" href="#example-advanced-country-mapping">Example: Advanced Country Mapping</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#binary-mappers">Binary Mappers</a><ul>
<li><a class="reference internal" href="#mapper-binary-field"><code class="docutils literal notranslate"><span class="pre">mapper.binary(field)</span></code></a><ul>
<li><a class="reference internal" href="#id3">How it works</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mapper-binary-url-map-field"><code class="docutils literal notranslate"><span class="pre">mapper.binary_url_map(field)</span></code></a><ul>
<li><a class="reference internal" href="#id4">How it works</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-techniques">Advanced Techniques</a><ul>
<li><a class="reference internal" href="#pre-processing-data">Pre-processing Data</a><ul>
<li><a class="reference internal" href="#adding-columns">Adding Columns</a></li>
<li><a class="reference internal" href="#removing-lines">Removing Lines</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-custom-mappers">Creating Custom Mappers</a></li>
<li><a class="reference internal" href="#updating-records-with-database-ids">Updating Records With Database IDs</a></li>
<li><a class="reference internal" href="#creating-related-records-mapper-record">Creating Related Records (<code class="docutils literal notranslate"><span class="pre">mapper.record</span></code>)</a><ul>
<li><a class="reference internal" href="#example-importing-sales-orders-and-their-lines">Example: Importing Sales Orders and their Lines</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({"startOnLoad": true})</script>
    </body>
</html>